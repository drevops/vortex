---
sidebar_label: FAQs
sidebar_position: 10
---

# FAQs

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

## How to know which `ahoy` commands are available?

```shell
ahoy help
```

## How to pass CLI arguments to commands?

```shell
ahoy mycommand -- myarg1 myarg2 --myoption1 --myoption2=myvalue
```

## How to clear Drupal cache?

<Tabs>
  <TabItem value="ahoy" label="Ahoy" default>
    ```shell
    ahoy drush cr
    ```
  </TabItem>
  <TabItem value="docker-compose" label="Docker Compose">
    ```shell
    docker compose exec cli drush cr
    ```
  </TabItem>
</Tabs>

## How to login to a Drupal site?

<Tabs>
  <TabItem value="ahoy" label="Ahoy" default>
    ```shell
    ahoy login
    ```
  </TabItem>
  <TabItem value="docker-compose" label="Docker Compose">
    ```shell
    docker compose exec cli drush uli
    ```
  </TabItem>
</Tabs>

## How to connect to the database?

<!-- markdownlint-disable MD046 -->
<Tabs>
  <TabItem value="ahoy" label="Ahoy" default>
    If you have [Sequel Ace](https://sequel-ace.com/):

    ```shell
    ahoy db
    ```

    Otherwise:

    1. Run `ahoy info` and grab the DB host port number.
    2. Use the connection details below.
  </TabItem>
  <TabItem value="docker-compose" label="Docker Compose">
    1. Run `docker compose ps` and find the database port mapping.
    2. Use the connection details below.
  </TabItem>
</Tabs>

<!-- markdownlint-enable MD046 -->

Connection details:

- Host: `127.0.0.1`
- Username: `drupal`
- Password: `drupal`
- Database: `drupal`
- Port: the port from the step above

## How to use Xdebug?

<!-- markdownlint-disable MD046 -->

<Tabs>
  <TabItem value="ahoy" label="Ahoy" default>
    1. Run `ahoy debug`.
    2. Enable listening for incoming debug connections in your IDE.
    3. If required, provide server URL to your IDE as it appears in the browser.
    4. Enable Xdebug flag in the request coming from your web browser (use one of
       the extensions or add `?XDEBUG_SESSION_START=1` to your URL).
    5. Set a breakpoint in your IDE and perform a request in the web browser.

    Use the same commands to debug CLI scripts.

    To disable, run `ahoy up`.
  </TabItem>
  <TabItem value="docker-compose" label="Docker Compose">
    1. Run `XDEBUG_ENABLE=true docker compose up -d cli php nginx`.
    2. Enable listening for incoming debug connections in your IDE.
    3. If required, provide server URL to your IDE as it appears in the browser.
    4. Enable Xdebug flag in the request coming from your web browser (use one of
       the extensions or add `?XDEBUG_SESSION_START=1` to your URL).
    5. Set a breakpoint in your IDE and perform a request in the web browser.

    Use the same commands to debug CLI scripts.

    To disable, run `docker compose up -d cli php nginx`.
  </TabItem>
</Tabs>

<!-- markdownlint-enable MD046 -->

➡️ See [Debugging](debugging.mdx)

## How to use Xdebug with Behat?

<!-- markdownlint-disable MD046 -->

<Tabs>
  <TabItem value="ahoy" label="Ahoy" default>
    1. Enable debugging: `ahoy debug`
    2. Enter CLI container: `ahoy cli`
    3. Run Behat tests:

    ```shell
    vendor/bin/behat --xdebug path/to/test.feature
    ```
  </TabItem>
  <TabItem value="docker-compose" label="Docker Compose">
    1. Enable debugging: `XDEBUG_ENABLE=true docker compose up -d cli php nginx`
    2. Enter CLI container: `docker compose exec cli bash`
    3. Run Behat tests:

    ```shell
    vendor/bin/behat --xdebug path/to/test.feature
    ```
  </TabItem>
</Tabs>

<!-- markdownlint-enable MD046 -->

## What should I do to switch to a "clean" branch environment?

Provided that your stack is already running:

<!-- markdownlint-disable MD046 -->

<Tabs>
  <TabItem value="ahoy" label="Ahoy" default>
    1. Switch to your branch
    2. `composer install`
    3. `ahoy provision`

    You do not need to rebuild the full stack using `ahoy build` every
    time you switch branches. `ahoy provision` will update the environment
    to match the current branch.

    However, sometimes you would want to have an absolutely clean environment - in
    that case, use `ahoy build`.
  </TabItem>
  <TabItem value="docker-compose" label="Docker Compose">
    1. Switch to your branch
    2. `docker compose exec cli composer install`
    3. `docker compose exec cli ./scripts/vortex/provision.sh`

    You do not need to rebuild the full stack every time you switch branches.
    The provision script will update the environment to match the current branch.

    However, sometimes you would want to have an absolutely clean environment - in
    that case, run:

    ```shell
    docker compose down
    ./scripts/vortex/reset.sh
    docker compose up -d --build --force-recreate
    docker compose exec cli ./scripts/vortex/provision.sh
    ```
  </TabItem>
</Tabs>

<!-- markdownlint-enable MD046 -->

## How to just import a database?

Provided that your stack is already running:

<!-- markdownlint-disable MD046 -->

<Tabs>
  <TabItem value="ahoy" label="Ahoy" default>
    ```shell
    ahoy import-db
    ahoy import-db .data/db_custom.sql
    ```
  </TabItem>
  <TabItem value="docker-compose" label="Docker Compose">
    ```shell
    docker compose exec cli ./scripts/vortex/import-db.sh
    docker compose exec cli ./scripts/vortex/import-db.sh .data/db_custom.sql
    ```
  </TabItem>
</Tabs>

<!-- markdownlint-enable MD046 -->

## How to add Drupal modules

<Tabs>
  <TabItem value="ahoy" label="Ahoy" default>
    ```shell
    ahoy composer require drupal/module_name
    ```
  </TabItem>
  <TabItem value="docker-compose" label="Docker Compose">
    ```shell
    docker compose exec cli composer require drupal/module_name
    ```
  </TabItem>
</Tabs>

## How to add patches for Drupal modules

1. Add `title` to patch on https://drupal.org to the `patches` array in `extra`
   section in `composer.json`.

   ```json
   "extra": {
       "patches": {
           "drupal/somepackage": {
               "Remote patch description": "https://www.drupal.org/files/issues/issue.patch"
               "Local patch description": "patches/package-description.patch"
           }
       }
   }
   ```

2. Run

<Tabs>
  <TabItem value="ahoy" label="Ahoy" default>
    ```shell
    ahoy composer require drupal/somepackage
    ```
  </TabItem>
  <TabItem value="docker-compose" label="Docker Compose">
    ```shell
    docker compose exec cli composer require drupal/somepackage
    ```
  </TabItem>
</Tabs>

➡️ See [Composer > Patching](composer.mdx#patching)

## What should I do when Composer blocks package installation due to security vulnerabilities?

Starting with Composer 2.9.0, Composer can automatically block the installation
or update of packages with known security vulnerabilities. If you encounter this
issue, you have several options:

1. **Update the affected packages**: Try updating to newer versions that don't
   have known vulnerabilities: `composer update vendor/package-name`
2. **Review the vulnerability**: Run `composer audit` to see details about the
   security issues and determine if they affect your project.
3. **Adjust security settings**: If you need to proceed with installation despite
   warnings (for example, if no secure version is available or the vulnerability
   doesn't affect your use case), you can configure the `audit.block-insecure`
   setting in your `composer.json`.

➡️ See [Composer > Security auditing](composer.mdx#security-auditing) for detailed
information about the `audit` configuration option and guidance on choosing the
right security settings for your project.

## How to set a custom maintenance theme?

To set a custom theme for Drupal's maintenance mode (when the site is offline
for updates), set the `DRUPAL_MAINTENANCE_THEME` environment variable:

```shell
# In .env file
DRUPAL_MAINTENANCE_THEME=my_custom_theme
```

This theme will be used when Drupal is in maintenance mode. If
`DRUPAL_MAINTENANCE_THEME` is not set, the system will fall back to using the
value of `DRUPAL_THEME`.

The maintenance theme should be a valid Drupal theme that is already installed
and enabled on your site.

## Behat tests with `@javascript` tag sometimes get stuck

Behat tests with `@javascript` tag sometimes get stuck for about 10min then
fail. The Chrome container randomly gets stuck for an unknown reason.

Restart the Chrome container: `docker compose restart chrome`
